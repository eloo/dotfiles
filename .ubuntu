# Ubuntu specific dotfile for zsh

# Workaround for missing distro icons
OS_ICON='\uE271'

#
# Antibody bundles
#

antibody bundle robbyrussell/oh-my-zsh path:plugins/ubuntu

#
# Ubuntu specific aliases
#

alias ls='gls -AFh ${colorflag} --group-directories-first'
alias ports='sudo netstat -tulpen'
alias code=codium

#
# Ubuntu functions
#

function localip(){
  echo "ðŸ“¶  "$(ip addr show | grep "inet\b" | awk '{print $2}' | cut -d/ -f1)
}

function apt-history(){
      case "$1" in
        install)
              grep 'install ' /var/log/dpkg.log
              ;;
        upgrade|remove)
              grep $1 /var/log/dpkg.log
              ;;
        rollback)
              grep upgrade /var/log/dpkg.log | \
                  grep "$2" -A10000000 | \
                  grep "$3" -B10000000 | \
                  awk '{print $4"="$5}'
              ;;
        *)
              cat /var/log/dpkg.log
              ;;
      esac
}

function apt-install-history(){
	comm -23 <(find /var/log/apt/ -name "history.*" -exec zsh -c "zgrep 'apt-get install' {}" \; | sed 's/.* //' | sort) <(find /var/log/apt/ -name "history.*" -exec zsh -c "zgrep 'apt-get remove' {}" \; | sed 's/.* //' | sort)
}

function 4ktofhd(){
      ffmpeg -i $1 -vf scale=1920:1080 -c:v libx264 -crf 20 -preset slow fhd-$1
}

function cleanSnaps(){
  snap list --all | awk '/deaktiviert/{print $1, $3}' |
      while read snapname revision; do
          sudo snap remove "$snapname" --revision="$revision"
      done
}

function renameMediaFilesToCreateDate(){
      exiftool -r '-FileName<CreateDate' -d %Y-%m-%d_%H-%M-%S%%-c.%%e * $1
}

function renameMediaFilesToDateTimeOriginal(){
      exiftool -r '-FileName<DateTimeOriginal' -d %Y-%m-%d_%H-%M-%S%%-c.%%e * $1
}

function renameMediaFilesToCreateDateWithFolders(){
      exiftool -r '-FileName<CreateDate' -d %Y/%m/%Y-%m-%d_%H-%M-%S%%-c.%%e * $1
}

function renameMediaFilesToDateTimeOriginalWithFolders(){
      exiftool -r '-FileName<DateTimeOriginal' -d %Y/%m/%Y-%m-%d_%H-%M-%S%%-c.%%e * $1
}

gitkraken() {
      if [ "$1" != "" ]
      then
		/usr/bin/gitkraken -p $1 1>/dev/null &
	else
		/usr/bin/gitkraken -p . 1>/dev/null &
	fi
}

alias ll='ls -alh'
